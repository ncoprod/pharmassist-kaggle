{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "pharmassist://contracts/pharmacy_event_payload.schema.json",
  "title": "Pharmacy Event Payload (synthetic dataset)",
  "description": "Whitelisted payload shapes for pharmacy-year synthetic events. This intentionally excludes any raw OCR/PDF text or other free-form blobs.",
  "oneOf": [
    {
      "type": "object",
      "additionalProperties": false,
      "required": ["intake_extracted"],
      "properties": {
        "intake_extracted": {
          "$ref": "pharmassist://contracts/intake_extracted.schema.json"
        }
      }
    },
    {
      "type": "object",
      "additionalProperties": false,
      "required": ["items"],
      "properties": {
        "items": {
          "type": "array",
          "minItems": 1,
          "maxItems": 50,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["sku", "qty"],
            "properties": {
              "sku": {
                "$ref": "pharmassist://contracts/_meta.schema.json#/$defs/non_empty_string"
              },
              "qty": {
                "type": "integer",
                "minimum": 1,
                "maximum": 99
              }
            }
          }
        }
      }
    },
    {
      "type": "object",
      "additionalProperties": false,
      "required": ["rx_medications"],
      "properties": {
        "rx_medications": {
          "type": "array",
          "minItems": 1,
          "maxItems": 50,
          "items": {
            "$ref": "pharmassist://contracts/_meta.schema.json#/$defs/non_empty_string"
          }
        }
      }
    },
    {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "doc_ref",
        "sha256_12",
        "page_count",
        "text_length",
        "redaction_applied",
        "redaction_replacements"
      ],
      "properties": {
        "doc_ref": {
          "$ref": "pharmassist://contracts/_meta.schema.json#/$defs/non_empty_string"
        },
        "sha256_12": {
          "type": "string",
          "pattern": "^[a-f0-9]{12}$"
        },
        "page_count": {
          "type": "integer",
          "minimum": 1,
          "maximum": 200
        },
        "text_length": {
          "type": "integer",
          "minimum": 1,
          "maximum": 50000
        },
        "redaction_applied": {
          "type": "boolean"
        },
        "redaction_replacements": {
          "type": "integer",
          "minimum": 0,
          "maximum": 2000
        }
      }
    }
  ]
}
